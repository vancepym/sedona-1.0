//
// Copyright (c) 2007 Tridium, Inc
// Licensed under the Academic Free License version 3.0
//
// History:
//   17 May 07  Andy Sunders  Creation
//

**
** DlyOnOffTest
**
class DlyOnOffTest
  extends Test
{
  static inline DlyOn dlyOn
  static inline DlyOff dlyOff

  static void test()
  {
    dlyOn.start()
    dlyOff.start()

    dlyOn.delayTime = 1.0
    dlyOff.delayTime = 1.0
    dlyOn.in = false
    dlyOff.in = true
    dlyOn.execute()
    dlyOff.execute()
    assert(dlyOn.out == false)
    assert(dlyOff.out == true)
    dlyOn.in = true
    dlyOff.in = false
    long startTicks = Sys.ticks()

    Sys.out.print("DlyOnOffTest: startTicks is ${startTicks}\n")

    while( (Sys.ticks() - startTicks) < 1000ms)
    {
      dlyOn.execute()
      dlyOff.execute()
      assert(dlyOn.out == false)
      assert(dlyOff.out == true)
    }

    Sys.out.print("DlyOnOffTest: first while ended after ${Sys.ticks()-startTicks}ns\n")

    startTicks = Sys.ticks()
    while((Sys.ticks() - startTicks) < 20ms)
    {
    }

    Sys.out.print("DlyOnOffTest: second while ended after ${Sys.ticks()-startTicks}ns\n")

    dlyOn.execute()
    dlyOff.execute()
    assert(dlyOn.out == true)
    assert(dlyOff.out == false)


  }




}
